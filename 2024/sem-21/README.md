**Что такое mmap?**

`mmap` (memory mapping) — это системный вызов в Linux, который позволяет отобразить файл или область памяти в адресное пространство процесса. Это позволяет работать с файлами или памятью как с массивом байт в оперативной памяти, что упрощает доступ к данным и повышает производительность.

Всё выделение динамической памяти происходит либо через `brk`, либо через `mmap`. Внутри `malloc`, `free` и тд используется `brk` для небольших блоков памяти и `mmap`, `munmap` для крупных.

Основные возможности mmap:

* Отображение файлов в память:
    - Файл можно отобразить в память, и затем работать с его содержимым как с массивом байт.
Это особенно полезно для работы с большими файлами, так как не нужно загружать их целиком в память.

* Создание анонимных отображений:
    - Можно создать область памяти, не связанную с файлом (анонимное отображение).
Это используется для выделения больших блоков памяти, например, для пулов памяти.

* Совместное использование памяти между процессами:
    - Отображённая память может быть доступна нескольким процессам, если используется флаг MAP_SHARED.

Основные параметры mmap:

* `void *addr`: Адрес начала отображения (обычно NULL, чтобы система выбрала адрес сама).
* `size_t length`: Размер отображаемой области.
* `int prot`: Права доступа (PROT_READ, PROT_WRITE, PROT_EXEC).
* `int flags`: Флаги (MAP_SHARED, MAP_PRIVATE, MAP_ANONYMOUS).
* `int fd`: Файловый дескриптор (если отображается файл).
* `off_t offset`: Смещение в файле (обычно 0).

Основные функции, связанные с mmap:

* `munmap`: Освобождает отображённую область памяти.
* `msync`: Синхронизирует изменения в отображённой памяти с файлом.
* `mprotect`: Изменяет права доступа к отображённой области.
